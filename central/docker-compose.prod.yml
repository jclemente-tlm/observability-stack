include:
  - path:
      - docker-compose.yml

services:
  alloy-gateway:
    mem_limit: 300m
    restart: always
    healthcheck:
      test: ["CMD", "wget", "-qO-", "http://localhost:4318/health"]
      interval: 10s
      timeout: 2s
      retries: 5

  loki:
    mem_limit: 700m
    restart: always
    healthcheck:
      test: ["CMD", "wget", "-qO-", "http://localhost:3100/ready"]
      interval: 10s
      timeout: 2s
      retries: 5

  tempo:
    mem_limit: 600m
    restart: always
    healthcheck:
      test: ["CMD", "wget", "-qO-", "http://localhost:3200/ready"]
      interval: 10s
      timeout: 2s
      retries: 5

  mimir:
    mem_limit: 1g
    restart: always
    healthcheck:
      test: ["CMD", "wget", "-qO-", "http://localhost:9009/ready"]
      interval: 15s
      timeout: 3s
      retries: 5

  grafana:
    mem_limit: 500m
    restart: always
    environment:
      GF_SECURITY_ALLOW_EMBEDDING: "false"
      GF_AUTH_DISABLE_LOGIN_FORM: "false"
      GF_LOG_LEVEL: "warn"
    healthcheck:
      test: ["CMD", "wget", "-qO-", "http://localhost:3000/api/health"]
      interval: 10s
      timeout: 3s
      retries: 5

  node-exporter:
    mem_limit: 120m
    restart: always

  cadvisor:
    mem_limit: 350m
    restart: always
